<?xml version="1.0" encoding="UTF-8"?>
<unload unload_date="2018-08-30 10:56:38">
<sysevent_in_email_action action="INSERT_OR_UPDATE">
<action>record_action</action>
<active>false</active>
<assignment_operator/>
<condition_script/>
<description>This inbound email action is triggered when an email is sent to ServiceNow and:

1. The email is a reply.
2. The email being replied to was sent by ServiceNow due to an update or creation of a Requested Item.


This inbound email action can update the following fields on a Requested Item:

assigned_to
priority

In addition to being able to explicitly set the values of the above fields within the email, the whole email is added to the Requested Item as a comment.


Example reply email: This reply will update comments for the request with "Let's get this ASAP." It will also set priority to "1" if the sender has the itil role.

-----

From: 	Fred Luddy &lt;fred.luddy@example.com&gt;
Subject: 	Re: Request REQ0010001 has been opened on your behalf
Date: 	June 10, 2013 5:56:00 PM PDT
To: 	        ServiceNow

priority: 1

Let's get this ASAP.

On Jun 10, 2013, at 5:52 PM, IT Service Desk wrote:

Click here to view Request: REQ0010001
 
Number: REQ0010001
Due date: 2013-06-15 17:00:00 PDT
Opened: 2013-06-10 17:42:26 PDT
Approval: Approved
 

Requested items:
 
Ref:MSG0000002

-----</description>
<event_name>email.read</event_name>
<filter_condition table="sys_email">user_id.sys_domain=ef6c5ab337f40f801de98ff1b3990e06^subjectLIKEREQ^EQ<item goto="false" or="false" field="subject" endquery="false" value="REQ" operator="LIKE" newquery="false"/>
<item goto="false" or="false" field="" endquery="true" value="" operator="=" newquery="false"/>
</filter_condition>
<from display_value=""/>
<name>Update Request_FLS</name>
<order>100</order>
<reply_email/>
<required_roles/>
<script><![CDATA[gs.include('validators');

if (current.getTableName() == "sc_request") {
	current.comments = "reply from: " + email.origemail + "\n\n" + email.body_text;
	
	if (gs.hasRole("itil")) {
		if (email.body.assign != undefined)
			current.assigned_to = email.body.assign;
		
		if (email.body.priority != undefined && isNumeric(email.body.priority))
			current.priority = email.body.priority;
	}
	
	current.update();
}]]></script>
<stop_processing>true</stop_processing>
<sys_class_name>sysevent_in_email_action</sys_class_name>
<sys_created_by>Sonali.Choudhary@in.unisys.com</sys_created_by>
<sys_created_on>2018-08-29 15:56:57</sys_created_on>
<sys_customer_update>false</sys_customer_update>
<sys_domain>global</sys_domain>
<sys_domain_path>/</sys_domain_path>
<sys_id>6cd1a3d4dbd06f8c7da8273605961953</sys_id>
<sys_mod_count>2</sys_mod_count>
<sys_name>Update Request_FLS</sys_name>
<sys_overrides display_value=""/>
<sys_package display_value="Global" source="global">global</sys_package>
<sys_policy/>
<sys_replace_on_upgrade>false</sys_replace_on_upgrade>
<sys_scope display_value="Global">global</sys_scope>
<sys_update_name>sysevent_in_email_action_6cd1a3d4dbd06f8c7da8273605961953</sys_update_name>
<sys_updated_by>Sonali.Choudhary@in.unisys.com</sys_updated_by>
<sys_updated_on>2018-08-30 10:55:56</sys_updated_on>
<table>sc_request</table>
<template/>
<type>reply</type>
</sysevent_in_email_action>
</unload>
